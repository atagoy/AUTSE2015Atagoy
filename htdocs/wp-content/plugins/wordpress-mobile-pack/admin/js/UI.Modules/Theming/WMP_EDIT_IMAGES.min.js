function WMP_EDIT_IMAGES(){var JSObject=this;this.type="wmp_editimages";this.form;this.DOMDoc;this.send_btn;this.deletingIcon=false;this.deletingLogo=false;this.init=function(){WMPJSInterface=window.parent.WMPJSInterface;this.send_btn=jQuery("#"+this.type+"_send_btn",this.DOMDoc).get(0);this.form=this.DOMDoc.getElementById(this.type+"_form");this.addButtonsActions();if(this.form==null){return}this.initValidation()};this.initValidation=function(){this.validator=jQuery("#"+this.form.id,this.DOMDoc).validate({rules:{wmp_editimages_icon:{accept:"png|jpg|jpeg|gif"},wmp_editimages_logo:{accept:"png"}},messages:{wmp_editimages_icon:{accept:"Please add a png, gif or jpeg image."},wmp_editimages_logo:{accept:"Please add a png image format with a transparent background."}},errorPlacement:function(e,t){var n=t[0].id.split("_");var r=n.length>1?n[n.length-1]:n[0];var i=jQuery("#error_"+r+"_container",JSObject.DOMDoc);e.appendTo(i)},errorElement:"span"});var $Icon=jQuery("#"+this.type+"_icon",this.DOMDoc);var $RemoveIconLink=jQuery("#"+this.type+"_icon_removenew",this.DOMDoc);$Icon.bind("change",function(){$Icon.focus();$Icon.blur();if(this.files[0])jQuery("#fakefileicon").val(this.files[0].name);$RemoveIconLink.css("display","block")});$RemoveIconLink.bind("click",function(){jQuery("#fakefileicon").val("");$Icon.val("");jQuery(JSObject.form).validate().element("#"+JSObject.type+"_icon");$RemoveIconLink.css("display","none")});var $EditIconLink=jQuery("."+this.type+"_changeicon",this.DOMDoc);if($EditIconLink.length>0){$EditIconLink.click(function(){if(jQuery("."+JSObject.type+"_uploadicon",JSObject.DOMDoc).css("display")=="none"){$Icon.val("");jQuery(JSObject.form).validate().element("#"+JSObject.type+"_icon");jQuery("#fakefileicon").val("");$RemoveIconLink.css("display","none");jQuery("."+JSObject.type+"_uploadicon",JSObject.DOMDoc).show();if(jQuery("#"+JSObject.type+"_currenticon",JSObject.DOMDoc).attr("src")!="")jQuery("."+JSObject.type+"_changeicon_cancel",JSObject.DOMDoc).show();if(jQuery("."+JSObject.type+"_iconcontainer",JSObject.DOMDoc).css("display")=="block")jQuery("."+JSObject.type+"_iconcontainer",JSObject.DOMDoc).hide()}})}var $CancelEditIconLink=jQuery("."+this.type+"_changeicon_cancel a",this.DOMDoc);if($CancelEditIconLink.length>0){$CancelEditIconLink.click(function(){if(jQuery("."+JSObject.type+"_uploadicon",JSObject.DOMDoc).css("display")=="block"){$Icon.val("");jQuery(JSObject.form).validate().element("#"+JSObject.type+"_icon");jQuery("#fakefileicon").val("");jQuery("."+JSObject.type+"_uploadicon",JSObject.DOMDoc).hide();jQuery(this).parent().hide();if(jQuery("."+JSObject.type+"_iconcontainer",JSObject.DOMDoc).css("display")=="none"&&jQuery("#"+JSObject.type+"_currenticon",JSObject.DOMDoc).attr("src")!="")jQuery("."+JSObject.type+"_iconcontainer",JSObject.DOMDoc).show()}})}var $DeleteIconLink=jQuery("."+this.type+"_deleteicon",this.DOMDoc);if($DeleteIconLink.length>0){var href=$DeleteIconLink.get(0).href;$DeleteIconLink.get(0).href="javascript:void(0);";$DeleteIconLink.click(function(){var isConfirmed=confirm("This app icon is used when the app is added to the homescreen. Are you sure you want to remove it?");if(isConfirmed){jQuery.get(ajaxurl,{action:"wmp_settings_editimages",type:"delete",source:"icon"},function(responseJSON){var JSON=eval("("+responseJSON+")");var response=Boolean(Number(String(JSON.status)));JSObject.deletingIcon=false;if(response==true){jQuery("#"+JSObject.type+"_currenticon",JSObject.DOMDoc).attr("src","");$EditIconLink.trigger("click");var message="The app icon has been removed.";WMPJSInterface.Loader.display({message:message})}else{var message="There was an error. Please try again in few seconds.";WMPJSInterface.Loader.display({message:message})}})}})}var $Logo=jQuery("#"+this.type+"_logo",this.DOMDoc);var $RemoveLogoLink=jQuery("#"+this.type+"_logo_removenew",this.DOMDoc);$Logo.bind("change",function(){$Logo.focus();$Logo.blur();if(this.files[0])jQuery("#fakefilelogo").val(this.files[0].name);$RemoveLogoLink.css("display","block")});$RemoveLogoLink.bind("click",function(){jQuery("#fakefilelogo").val("");$Logo.val("");jQuery(JSObject.form).validate().element("#"+JSObject.type+"_logo");$RemoveLogoLink.css("display","none")});var $EditLogoLink=jQuery("."+this.type+"_changelogo",this.DOMDoc);if($EditLogoLink.length>0){$EditLogoLink.click(function(){if(jQuery("."+JSObject.type+"_uploadlogo",JSObject.DOMDoc).css("display")=="none"){$Logo.val("");jQuery(JSObject.form).validate().element("#"+JSObject.type+"_logo");jQuery("#fakefilelogo").val("");$RemoveLogoLink.css("display","none");jQuery("."+JSObject.type+"_uploadlogo",JSObject.DOMDoc).show();if(jQuery("#"+JSObject.type+"_currentlogo",JSObject.DOMDoc).css("background-image")!="none")jQuery("."+JSObject.type+"_changelogo_cancel",JSObject.DOMDoc).show();if(jQuery("."+JSObject.type+"_logocontainer",JSObject.DOMDoc).css("display")=="block")jQuery("."+JSObject.type+"_logocontainer",JSObject.DOMDoc).hide()}})}var $CancelEditLogoLink=jQuery("."+this.type+"_changelogo_cancel a",this.DOMDoc);if($CancelEditLogoLink.length>0){$CancelEditLogoLink.click(function(){if(jQuery("."+JSObject.type+"_uploadlogo",JSObject.DOMDoc).css("display")=="block"){$Logo.val("");jQuery(JSObject.form).validate().element("#"+JSObject.type+"_logo");jQuery("#fakefilelogo").val("");jQuery("."+JSObject.type+"_uploadlogo",JSObject.DOMDoc).hide();jQuery(this).parent().hide();if(jQuery("."+JSObject.type+"_logocontainer",JSObject.DOMDoc).css("display")=="none"&&jQuery("#"+JSObject.type+"_currentlogo",JSObject.DOMDoc).css("background-image")!="none")jQuery("."+JSObject.type+"_logocontainer",JSObject.DOMDoc).show()}})}var $DeleteLogoLink=jQuery("."+this.type+"_deletelogo",this.DOMDoc);if($DeleteLogoLink.length>0){var href=$DeleteLogoLink.get(0).href;$DeleteLogoLink.get(0).href="javascript:void(0);";$DeleteLogoLink.click(function(){var isConfirmed=confirm("This app logo is used on the cover of your app. Are you sure you want to remove it?");if(isConfirmed){jQuery.get(ajaxurl,{action:"wmp_settings_editimages",type:"delete",source:"logo"},function(responseJSON){var JSON=eval("("+responseJSON+")");var response=Boolean(Number(String(JSON.status)));JSObject.deletingIcon=false;if(response==true){jQuery("#"+JSObject.type+"_currentlogo",JSObject.DOMDoc).css("background-image","none");$EditLogoLink.trigger("click");var message="The app logo has been removed.";WMPJSInterface.Loader.display({message:message})}else{var message="There was an error. Please try again in few seconds.";WMPJSInterface.Loader.display({message:message})}})}})}};this.displayImage=function(e,t){if(e=="icon"){jQuery("#"+JSObject.type+"_icon",JSObject.DOMDoc).val("");jQuery("#fakefileicon").val("");jQuery("."+JSObject.type+"_uploadicon",JSObject.DOMDoc).hide();jQuery("."+JSObject.type+"_changeicon_cancel",JSObject.DOMDoc).hide();jQuery("#"+JSObject.type+"_currenticon",JSObject.DOMDoc).attr("src",t);jQuery("."+JSObject.type+"_iconcontainer",JSObject.DOMDoc).css("display","block")}else if(e=="logo"){jQuery("#"+JSObject.type+"_logo",JSObject.DOMDoc).val("");jQuery("#fakefilelogo").val("");jQuery("."+JSObject.type+"_uploadlogo",JSObject.DOMDoc).hide();jQuery("."+JSObject.type+"_changelogo_cancel",JSObject.DOMDoc).hide();jQuery("#"+JSObject.type+"_currentlogo",JSObject.DOMDoc).css("background-image","url("+t+")");jQuery("."+JSObject.type+"_logocontainer",JSObject.DOMDoc).css("display","block")}};this.addButtonsActions=function(){jQuery(this.send_btn).unbind("click");jQuery(this.send_btn).bind("click",function(){JSObject.disableButton(this);JSObject.validate()});JSObject.enableButton(this.send_btn)};this.enableButton=function(e){jQuery(e).css("cursor","pointer");jQuery(e).animate({opacity:1},100)};this.disableButton=function(e){jQuery(e).unbind("click");jQuery(e).animate({opacity:.4},100);jQuery(e).css("cursor","default")};this.scrollToError=function(e){var t=jQuery("html,body",JSObject.DOMDoc);var n=parseInt(jQuery("html,body").scrollTop())||parseInt(jQuery("body").scrollTop());var r=t.get(0).clientHeight;var i=parseInt(t.offset().top);if(e<n){jQuery(t).animate({scrollTop:e-20},1e3)}else if(e>n+r){jQuery(t).animate({scrollTop:n+r},1e3)}};this.validate=function(){jQuery(this.form).validate().form();var e=[];for(var t in this.validator.invalid){var n=jQuery(this.form[t]);e.push(n.offset().top)}if(e.length==0){this.sendData()}else{e.sort(function(e,t){return e-t});JSObject.scrollToError(e[0]);JSObject.addButtonsActions()}};this.submitForm=function(){return WMPJSInterface.AjaxUpload.dosubmit(JSObject.form,{onStart:JSObject.startUploadingData,onComplete:JSObject.completeUploadingData})};this.sendData=function(){jQuery("#"+this.form.id,this.DOMDoc).unbind("submit");jQuery("#"+this.form.id,this.DOMDoc).bind("submit",function(){JSObject.submitForm()});jQuery("#"+this.form.id,this.DOMDoc).submit();JSObject.disableButton(JSObject.send_btn)};this.startUploadingData=function(){WMPJSInterface.Preloader.start();setTimeout(function(){var e=JSObject.form.elements;nElems=e.length;for(j=0;j<nElems;j++){e[j].disabled=true}},300);return true};this.completeUploadingData=function(responseJSON){jQuery("#"+JSObject.form.id,JSObject.DOMDoc).unbind("submit");jQuery("#"+JSObject.form.id,JSObject.DOMDoc).bind("submit",function(){return false});WMPJSInterface.Preloader.remove(100);JSON=eval("("+responseJSON+")");response=Boolean(Number(String(JSON.status)));if(JSON.uploaded_icon!=undefined)JSObject.displayImage("icon",JSON.uploaded_icon);if(JSON.uploaded_logo!=undefined)JSObject.displayImage("logo",JSON.uploaded_logo);if(response==true&&JSON.messages.length==0){var message="Your app has been successfully modified!";WMPJSInterface.Loader.display({message:message})}else{if(JSON.messages.length==0){var message="There was an error. Please reload the page and try again.";WMPJSInterface.Loader.display({message:message})}else{for(i=0;i<JSON.messages.length;i++)WMPJSInterface.Loader.display({message:JSON.messages[i]})}}setTimeout(function(){var e=JSObject.form.elements;nElems=e.length;for(j=0;j<nElems;j++){e[j].disabled=false}},300);JSObject.addButtonsActions()}}