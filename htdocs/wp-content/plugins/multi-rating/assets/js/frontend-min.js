jQuery(document).ready(function(){function r(r){var s=jQuery.parseJSON(r),t=s.data.post_id+"-"+s.data.sequence,e=jQuery("#rating-form-"+t);if("success"==s.status){var a=jQuery(".rating-result-"+s.data.post_id).filter(".mr-filter");a&&a.replaceWith(s.data.html)}if(jQuery("#rating-form-"+t+" .rating-item .mr-error").html(""),s.validation_results&&s.validation_results.length>0||s.message){var m="";if(s.validation_results){var l=0;for(l;l<s.validation_results.length;l++)s.validation_results[l].field&&jQuery("#"+s.validation_results[l].field+"-"+s.data.sequence+"-error").length?jQuery("#"+s.validation_results[l].field+"-"+s.data.sequence+"-error").html(s.validation_results[l].message):m+='<p class="mr message mr-'+s.validation_results[l].severity+'">'+s.validation_results[l].message+"</p>"}s.message&&(m+='<p class="message '+s.status+'">'+s.message+"</p>"),e&&e.parent().find(".message")&&e.parent().find(".message").remove(),e&&e.parent()&&e.before(m)}"success"==s.status&&1==s.data.hide_rating_form&&e&&e.remove();var u="mr-spinner-"+t;jQuery("#"+u).remove()}function s(r,s){var e=t(r);null!=e&&(m[e]=s)}function t(r){var s=r.split("-"),t=s[4],e=s[5],a="rating-item-"+t+"-"+e;return a}function e(r){var s=r.id,t=s.split("-"),e=t[1],a=t[4],m=t[5],l="#rating-item-"+a+"-"+m;jQuery(l).val(e)}var a=jQuery.parseJSON(mr_frontend_data.icon_classes);jQuery(".rating-form :button").click(function(s){{var t=[],e=s.currentTarget.id,m=e.split("-"),l=m[1],u=m[2],o="#ratingEntryId-"+l+"-"+u;jQuery(o)}jQuery('.rating-form input[type="hidden"].rating-item-'+l+"-"+u).each(function(r){var s=jQuery(this).val(),e=jQuery("[name=rating-item-"+s+"-"+u+"]"),a=null;a=jQuery(e).is(":radio")?jQuery('input[type="radio"][name=rating-item-'+s+"-"+u+"]:checked").val():jQuery(e).is("select")?jQuery("select[name=rating-item-"+s+"-"+u+"] :selected").val():jQuery("input[type=hidden][name=rating-item-"+s+"-"+u+"]").val();var m={id:s,value:a};t[r]=m});var i={action:"save_rating",nonce:mr_frontend_data.ajax_nonce,ratingItems:t,postId:l,sequence:u},n=l+"-"+u,d="mr-spinner-"+n;jQuery('<i style="margin-left: 10px;" id="'+d+'" class="'+a.spinner+'"></i>').insertAfter("input#"+e),jQuery.post(mr_frontend_data.ajax_url,i,function(s){r(s)})});var m={},l=jQuery.parseJSON(mr_frontend_data.use_custom_star_images);jQuery(".mr-star-rating-select .mr-star-empty, .mr-star-rating-select .mr-star-full").on("click",function(){s(this.id,"clicked"),1==l?(jQuery(this).not(".mr-minus").removeClass("mr-custom-empty-star mr-custom-hover-star mr-star-hover").addClass("mr-custom-full-star"),jQuery(this).prevAll().not(".mr-minus").removeClass("mr-custom-empty-star mr-custom-hover-star mr-star-hover").addClass("mr-custom-full-star"),jQuery(this).nextAll().not(".mr-minus").removeClass("mr-custom-full-star mr-custom-hover-star mr-star-hover").addClass("mr-custom-empty-star")):(jQuery(this).not(".mr-minus").removeClass(a.star_empty+" mr-star-hover").addClass(a.star_full),jQuery(this).prevAll().not(".mr-minus").removeClass(a.star_empty+" mr-star-hover").addClass(a.star_full),jQuery(this).nextAll().not(".mr-minus").removeClass(a.star_full+" mr-star-hover").addClass(a.star_empty)),e(this)}),jQuery(".mr-star-rating-select .mr-minus").on("click",function(){s(this.id,""),1==l?(jQuery(this).not(".mr-minus").removeClass("mr-custom-empty-star mr-custom-hover-star mr-star-hover").addClass("mr-custom-full-star"),jQuery(this).prevAll().not(".mr-minus").removeClass("mr-custom-empty-star mr-custom-hover-star mr-star-hover").addClass("mr-custom-full-star"),jQuery(this).nextAll().not(".mr-minus").removeClass("mr-custom-full-star mr-custom-hover-star mr-star-hover").addClass("mr-custom-empty-star")):(jQuery(this).not(".mr-minus").removeClass(a.star_empty+" mr-star-hover").addClass(a.star_full),jQuery(this).prevAll().not(".mr-minus").removeClass(a.star_empty+" mr-star-hover").addClass(a.star_full),jQuery(this).nextAll().not(".mr-minus").removeClass(a.star_full+" mr-star-hover").addClass(a.star_empty)),e(this)}),jQuery(".mr-star-rating-select .mr-minus, .mr-star-rating-select .mr-star-empty, .mr-star-rating-select .mr-star-full").on("mouseenter mouseleave",function(){var r=this.id,e=t(r);(0==jQuery("#"+e).val()||"clicked"!=m[e]&&void 0!=m[e])&&(s(this.id,"hovered"),1==l?(jQuery(this).not(".mr-minus").removeClass("mr-custom-empty-star").addClass("mr-custom-hover-star mr-star-hover"),jQuery(this).prevAll().not(".mr-minus").removeClass("mr-custom-empty-star").addClass("mr-custom-hover-star mr-star-hover"),jQuery(this).nextAll().not(".mr-minus").removeClass("mr-custom-hover-star mr-star-hover").addClass("mr-custom-empty-star")):(jQuery(this).not(".mr-minus").removeClass(a.star_empty).addClass(a.star_full+" mr-star-hover"),jQuery(this).prevAll().not(".mr-minus").removeClass(a.star_empty).addClass(a.star_full+" mr-star-hover"),jQuery(this).nextAll().not(".mr-minus").removeClass(a.star_full+" mr-star-hover").addClass(a.star_empty)))});var u={started:null,currrentX:0,yCoord:0,previousXCoord:0,previousYCoord:0,touch:null};jQuery(".mr-star-rating-select .mr-star-empty, .mr-star-rating-select .mr-star-full, .mr-star-rating-select .mr-minus").on("touchstart",function(r){u.started=(new Date).getTime();var s=r.originalEvent.touches[0];u.previousXCoord=s.pageX,u.previousYCoord=s.pageY,u.touch=s}),jQuery(".mr-star-rating-select .mr-star-empty, .mr-star-rating-select .mr-star-full, .mr-star-rating-select .mr-minus").on("touchend touchcancel",function(){var r=(new Date).getTime();if(null!==u.started&&r-u.started<200&&null!==u.touch){var s=u.touch,t=s.pageX,m=s.pageY;u.previousXCoord===t&&u.previousYCoord===m&&(1==l?(jQuery(this).removeClass("mr-custom-empty-star").addClass("mr-custom-full-star"),jQuery(this).prevAll().removeClass("mr-custom-empty-star").addClass("mr-custom-full-star"),jQuery(this).nextAll().removeClass("mr-custom-full-star").addClass("mr-custom-empty-star")):(jQuery(this).not(".mr-minus").removeClass(a.star_empty).addClass(a.star_full),jQuery(this).prevAll().not(".mr-minus").removeClass(a.star_empty).addClass(a.star_full),jQuery(this).nextAll().not(".mr-minus").removeClass(a.star_full).addClass(a.star_empty)),e(this))}u.started=null,u.touch=null})});